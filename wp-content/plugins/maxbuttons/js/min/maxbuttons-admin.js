var maxAdmin;jQuery(document).ready(function($){maxAdmin=function(){return this},maxAdmin.prototype={colorUpdateTime:!0,fields:null,button_id:null,form_updated:!1,tabs:null},maxAdmin.prototype.init=function(){this.button_id=$('input[name="button_id"]').val(),$(document).on("click",".maxbutton-preview",function(t){t.preventDefault()}),$("#maxbuttons .input-paging").on("change",$.proxy(this.do_paging,this)),$(".manual-toggle").on("click",$.proxy(this.toggleManual,this)),$(".manual-entry").draggable({cancel:"p, li"}),$(document).on("submit","form.mb_ajax_save",$.proxy(this.formAjaxSave,this)),$(document).on("click","#maxbuttons [data-form]",$.proxy(this.buttonSubmit,this)),$(document).on("reInitConditionals",$.proxy(this.initConditionials,this)),this.initConditionials(),0!=$("#new-button-form").length&&(this.button_id>0&&$("#maxbuttons .mb-message").show(),this.initResponsive(),$("#maxbuttons .output").draggable({}),$(".colorpicker-box").each(function(){var t=$(this).attr("id").replace("_box","");$(this).children("span").css("backgroundColor",$("#"+t).val())}),$(".colorpicker-box span").on("click",this.showColorPicker),"undefined"!=typeof buttonFieldMap&&(this.fields=$.parseJSON(buttonFieldMap)),$("input").on("keyup change",$.proxy(this.update_preview,this)),$("select").on("change",$.proxy(this.update_preview,this)),$(document).on("colorUpdate",$.proxy(this.update_color,this)),$(window).on("beforeunload",$.proxy(function(){return this.form_updated?maxcol_wp.leave_page:void 0},this)),$(".button-save").click($.proxy(function(){return this.saveIndicator(!1),$("#new-button-form").submit(),!1},this)),$("#copy-normal-colors-to-hover").click($.proxy(this.copy_colors,this,"normal_to_hover")),$("#copy-hover-colors-to-normal").click($.proxy(this.copy_colors,this,"hover_to_normal")),$("#swap-normal-hover-colors").click($.proxy(this.copy_colors,this,"swap_normal_hover")),$("#copy-invert-normal-colors").click($.proxy(this.copy_colors,this,"invert")),$(".shortcode-expand").on("click",this.toggleShortcode))},maxAdmin.prototype.initTwitter=!function(t,o,e){var a,r=t.getElementsByTagName(o)[0],n=/^http:/.test(t.location)?"http":"https";t.getElementById(e)||(a=t.createElement(o),a.id=e,a.src=n+"://platform.twitter.com/widgets.js",r.parentNode.insertBefore(a,r))}(document,"script","twitter-wjs"),maxAdmin.prototype.copy_colors=function(t,o){o.preventDefault();var e=$("#text_color").val(),a=$("#text_shadow_color").val(),r=$("#gradient_start_color").val(),n=$("#gradient_end_color").val(),i=$("#border_color").val(),d=$("#box_shadow_color").val(),s=$("#text_color_hover").val(),c=$("#text_shadow_color_hover").val(),l=$("#gradient_start_color_hover").val(),p=$("#gradient_end_color_hover").val(),u=$("#border_color_hover").val(),h=$("#box_shadow_color_hover").val();if(("normal_to_hover"==t||"invert"==t)&&(s=e,c=a,l=r,p=n,u=i,h=d),"hover_to_normal"==t&&(e=s,a=c,r=l,n=p,i=u,d=h),"swap_normal_hover"==t){var _;_=e,e=s,s=_,_=a,a=c,c=_,_=r,r=l,l=_,_=n,n=p,p=_,_=i,i=u,u=_,_=d,d=h,h=_}"invert"==t&&(p=r,l=n),$("#text_color").val(e),$("#text_shadow_color").val(a),$("#gradient_start_color").val(r),$("#gradient_end_color").val(n),$("#border_color").val(i),$("#box_shadow_color").val(d),$("#text_color_hover").val(s),$("#text_shadow_color_hover").val(c),$("#gradient_start_color_hover").val(l),$("#gradient_end_color_hover").val(p),$("#border_color_hover").val(u),$("#box_shadow_color_hover").val(h),$(document).trigger("colorUpdate",[$("#text_color"),e]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#text_shadow_color"),a]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#gradient_start_color"),r]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#gradient_end_color"),n]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#border_color"),i]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#box_shadow_color"),d]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#text_color_hover"),s]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#text_shadow_color_hover"),c]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#gradient_start_color_hover"),l]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#gradient_end_color_hover"),p]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#border_color_hover"),u]),this.colorUpdateTime=!0,$(document).trigger("colorUpdate",[$("#box_shadow_color_hover"),h]),$("#text_color_box span").css("backgroundColor",e),$("#text_shadow_color_box span").css("backgroundColor",a),$("#gradient_start_color_box span").css("backgroundColor",r),$("#gradient_end_color_box span").css("backgroundColor",n),$("#border_color_box span").css("backgroundColor",i),$("#box_shadow_color_box span").css("backgroundColor",d),$("#text_color_hover_box span").css("backgroundColor",s),$("#text_shadow_color_hover_box span").css("backgroundColor",c),$("#gradient_start_color_hover_box span").css("backgroundColor",l),$("#gradient_end_color_hover_box span").css("backgroundColor",p),$("#border_color_hover_box span").css("backgroundColor",u),$("#box_shadow_color_hover_box span").css("backgroundColor",h)},maxAdmin.prototype.showColorPicker=function(t){$(this).mbColpick({layout:"rgbhex",submit:!1,colorScheme:"dark",height:220,onBeforeShow:function(){var t=$(this).parent().attr("id");t=t.replace("_box","");var o=$("#"+t).val();$("#colorpicker_current").val(t),("undefined"==typeof o||""==o)&&(o="#ffffff"),$(this).mbColpickSetColor(o)},onChange:function(t,o){var e=$("#colorpicker_current").val(),a=$("#"+e);$("#"+e).attr("value","#"+o),$("#"+e+"_box span").css("background-color","#"+o),$(document).trigger("colorUpdate",[a,o])},onShow:function(t){return $(t).fadeIn(500),$(t).css("z-index",500),!1},onHide:function(t){return $(t).fadeOut(500),!1}}),$(this).mbColpickShow(t)},maxAdmin.prototype.repaint_preview=function(){$('.mb_tab input[type="text"]').trigger("change"),$('.mb_tab input[type="number"]').trigger("change"),$(".mb_tab select").trigger("change"),$('.mb_tab input[type="hidden"]').trigger("change"),$('.mb_tab input[type="radio"]:checked').trigger("change"),$('.mb_tab input[type="checkbox"]:checked').trigger("change"),$(document).trigger("colorUpdate",["#text_color",$("#text_color").val()]),$(document).trigger("colorUpdate",["#text_color_hover",$("#text_color_hover").val()])},maxAdmin.prototype.update_preview=function(e){e.preventDefault(),this.saveIndicator(!0);var target=$(e.target),field=$(target).data("field");if("undefined"==typeof field)var id=$(target).attr("id");else var id=field;var data=this.fields[id];"undefined"!=typeof data&&("undefined"!=typeof data.css&&(value=target.val(),"undefined"!=typeof data.css_unit&&-1==value.indexOf(data.css_unit)&&(value+=data.css_unit),target.is(":checkbox")&&!target.is(":checked")&&(value=""),this.putCSS(data,value)),"undefined"!=typeof data.attr&&$(".output .result").find("a").attr(data.attr,target.val()),"undefined"!=typeof data.func&&eval("this."+data.func+"(target)"))},maxAdmin.prototype.putCSS=function(t,o,e){e=e||"both";var a=".maxbutton";if("hover"==e?a="a.hover ":"normal"==e&&(a="a.normal "),"undefined"!=typeof t.csspart){var r=t.csspart.split(",");for(i=0;i<r.length;i++){var n=r[i],d=a+" ."+n;$(".output .result").find(d).css(t.css,o)}}else $(".output .result").find(a).css(t.css,o)},maxAdmin.prototype.update_color=function(t,o,e){if(this.colorUpdateTime){this.colorUpdateTime=!1,setTimeout($.proxy(function(){this.colorUpdateTime=!0},this),250),t.preventDefault(),this.saveIndicator(!0),-1===e.indexOf("#")&&(e="#"+e);var a=$(o).attr("id");if(-1!==a.indexOf("box_shadow"))this.updateBoxShadow(o);else if(-1!==a.indexOf("text_shadow"))this.updateTextShadow(o);else if(-1!==a.indexOf("gradient"))-1==a.indexOf("hover")?this.updateGradient():this.updateGradient(!0);else{if("button_preview"!=a){state=-1==a.indexOf("hover")?"normal":"hover";var r=this.fields[a];return void this.putCSS(r,e,state)}$(".output .result").css("backgroundColor",e)}}},maxAdmin.prototype.updateGradient=function(t){t=t||!1;var o="";t&&(o="_hover");var e=parseInt($("#gradient_stop").val());isNaN(e)&&(e=45);var a=this.hexToRgb($("#gradient_start_color"+o).val()),r=this.hexToRgb($("#gradient_end_color"+o).val()),n=parseInt($("#gradient_start_opacity"+o).val()),i=parseInt($("#gradient_end_opacity"+o).val());if(isNaN(n)&&(n=100),isNaN(i)&&(i=100),t)var d=$(".output .result").find("a.hover");else var d=$(".output .result").find("a.normal");d.css("background","linear-gradient( rgba("+a+","+n/100+") "+e+"%, rgba("+r+","+i/100+") )"),d.css("background","-moz-linear-gradient( rgba("+a+","+n/100+") "+e+"%, rgba("+r+","+i/100+") )"),d.css("background","-o-linear-gradient( rgba("+a+","+n/100+") "+e+"%, rgba("+r+","+i/100+") )"),d.css("background","-webkit-gradient(linear, left top, left bottom, color-stop("+e+"%, rgba("+a+","+n/100+")), color-stop(1, rgba("+r+","+i/100+") ));")},maxAdmin.prototype.hexToRgb=function(t){t=t.replace("#","");var o=parseInt(t,16),e=o>>16&255,a=o>>8&255,r=255&o;return e+","+a+","+r},maxAdmin.prototype.updateBoxShadow=function(t){t=t||null;var o=$("#box_shadow_offset_left").val(),e=$("#box_shadow_offset_top").val(),a=$("#box_shadow_width").val(),r=$("#box_shadow_color").val(),n=$("#box_shadow_color_hover").val();$(".output .result").find("a.normal").css("boxShadow",o+"px "+e+"px "+a+"px "+r),$(".output .result").find("a.hover").css("boxShadow",o+"px "+e+"px "+a+"px "+n)},maxAdmin.prototype.updateTextShadow=function(t,o){o=o||!1;var e=$("#text_shadow_offset_left").val(),a=$("#text_shadow_offset_top").val(),r=$("#text_shadow_width").val(),n=$("#text_shadow_color").val(),i=$("#text_shadow_color_hover").val(),d=$(t).attr("id"),s=this.fields[d];s.css="textShadow";var c=e+"px "+a+"px "+r+"px "+n;this.putCSS(s,c,"normal"),c=e+"px "+a+"px "+r+"px "+i,this.putCSS(s,c,"hover")},maxAdmin.prototype.updateAnchorText=function(t){var o=$(".output .result").find("a .mb-text");0===o.length&&($(".output .result").find("a").append('<span class="mb-text"></span>'),$(".output .result").find("a .mb-text").css({display:"block","line-height":"1em","box-sizing":"border-box"}),this.repaint_preview()),$(".output .result").find("a .mb-text").text(t.val())},maxAdmin.prototype.updateGradientOpacity=function(){this.updateGradient(!0),this.updateGradient(!1)},maxAdmin.prototype.updateDimension=function(t){var o=$(t).val(),e=$(t).attr("id"),a=this.fields[e];o>0?this.putCSS(a,o):this.putCSS(a,"auto")},maxAdmin.prototype.initResponsive=function(){this.checkAutoQuery(),$('input[name="auto_responsive"]').on("click",$.proxy(this.checkAutoQuery,this)),$(".add_media_query").on("click",$.proxy(this.addMediaQuery,this)),$(document).on("click",".removebutton",$.proxy(this.removeMediaQuery,this))},maxAdmin.prototype.checkAutoQuery=function(){$('input[name="auto_responsive"]').is(":checked")?$(".media_queries_options").hide():$(".media_queries_options").show()},maxAdmin.prototype.addMediaQuery=function(){this.saveIndicator(!0);var t=$(".media_option_prot").children().clone(),o=$("#new_query").val(),e=$("#new_query :selected").text(),a=$("#media_desc").children("#"+o).text();$(t).data("query",o),$(t).children('input[name="media_query[]"]').val(o),$(t).children(".title").text(e),$(t).children(".description").text(a),"custom"!==o&&$(t).children(".custom").hide();var r=$('input[name="next_media_index"]').val();$(t).find("select, input").each(function(){name=$(this).attr("name"),id=$(this).attr("id"),"undefined"!=typeof id&&$(this).attr("id",id.replace("[]","["+r+"]")),$(this).attr("name",name.replace("[]","["+r+"]"))}),r=parseInt(r),$('input[name="next_media_index"]').val(r+1),"custom"!==o&&($("#new_query :selected").prop("disabled",!0),$("#new_query :selected").prop("selected",!1)),$(".media_queries_options .new_query_space").append(t)},maxAdmin.prototype.removeMediaQuery=function(t){var o=t.target,e=$(o).parents(".media_query").data("query");$(o).parents(".media_query").fadeOut(function(){$(this).remove()}),$('#new_query option[value="'+e+'"]').prop("disabled",!1)},maxAdmin.prototype.do_paging=function(t){var o=parseInt($(t.target).val());if(o<=parseInt($(t.target).attr("max"))){var e=$(t.target).data("url");window.location=e+"&paged="+o}},maxAdmin.prototype.toggleShortcode=function(){$(".shortcode-expand").hasClass("closed")?($(" .mb-message.shortcode .expanded").css("display","inline-block"),$(".shortcode-expand span").removeClass("dashicons-arrow-down").addClass("dashicons-arrow-up"),$(".shortcode-expand").removeClass("closed").addClass("open")):($(" .mb-message.shortcode .expanded").css("display","none"),$(".shortcode-expand span").addClass("dashicons-arrow-down").removeClass("dashicons-arrow-up"),$(".shortcode-expand").addClass("closed").removeClass("open"))},maxAdmin.prototype.toggleManual=function(t){t.preventDefault();var o=$(t.target),e=o.data("target"),a=$('.manual-entry[data-manual="'+e+'"]');if(a.is(":visible"))return a.hide(),!0;var r=$('[data-options="'+e+'"]').position(),n=r.top+o.height();a.css("top",n),a.css("right",15),a.css("left","auto"),a.show()},maxAdmin.prototype.initConditionials=function(){var t=this;$(".conditional-option").each(function(){var o=$(this).data("show"),e=o.target,a=o.values;$(document).on("change",'[name="'+e+'"]',{child:this,values:a},$.proxy(t.updateConditional,t)),$('[name="'+e+'"]').trigger("change")})},maxAdmin.prototype.updateConditional=function(t){var o=t.data,e=o.values,a=o.child,r=$(t.currentTarget).val();e.indexOf(r)>=0?$(a).show():$(a).hide()},maxAdmin.prototype.saveIndicator=function(t){this.form_updated=t?!0:!1},maxAdmin.prototype.formAjaxSave=function(t){t.preventDefault();var o=mb_ajax.ajaxurl,e=$(t.target),a=e.serialize();$.ajax({type:"POST",url:o,data:a}).done($.proxy(this.saveDone,this))},maxAdmin.prototype.buttonSubmit=function(t){t.preventDefault(),$("[data-form]").prop("disabled",!0);var o=$(t.target).data("form");$("#"+o).submit()},maxAdmin.prototype.saveDone=function(t){$("[data-form]").prop("disabled",!1);var o=$.parseJSON(t),e=o.result,a=o.title,r=o.data.id;if("undefined"!=typeof o.data.new_nonce){{o.data.new_nonce}$('input[name="nonce"]').val(o.data.new_nonce)}if(e){$('input[name="collection_id"]').val(r);var n=window.location.href;-1===n.indexOf("collection_id")&&window.history.replaceState({},"",n+"&collection_id="+r),$(document).trigger("mbFormSaved");var i=$('input[name="sorted"]').val();$('input[name="previous_selection"]').val(i),o.data.reload&&document.location.reload(!0)}e||($modal=window.maxFoundry.maxmodal,$modal.newModal("collection_error"),$modal.setTitle(a),$modal.setContent(o.body),$modal.setControls('<button class="modal_close button-primary">'+o.close_text+"</button>"),$modal.show())}});